@using NEWS.Core.Entities
@model NEWS.Web.Areas.Admin.ViewModels.PostViewModel
@{
    ViewBag.Title = "پست";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}


@section PluginStylePage
{
    <link href="~/Areas/Admin/assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.css" rel="stylesheet" type="text/css" />
    <link href="~/Areas/Admin/assets/global/plugins/bootstrap-select/css/bootstrap-select.min.css" rel="stylesheet" />
    <link href="~/Areas/Admin/assets/global/plugins/bootstrap-select/css/bootstrap-select-rtl.css" rel="stylesheet" />
    <link href="~/Areas/Admin/assets/global/plugins/bootstrap-summernote/summernote.css" rel="stylesheet" type="text/css" />
    <link href="~/Areas/Admin/assets/global/plugins/bootstrap-tagsinput/bootstrap-tagsinput.css" rel="stylesheet" type="text/css" />

}

@section StylePage
{

}
@section PluginScriptPage
{
    <script src="~/Areas/Admin/assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.js" type="text/javascript"></script>
    <script src="~/Areas/Admin/assets/global/plugins/bootstrap-select/js/bootstrap-select.min.js"></script>
    <script src="~/Areas/Admin/assets/global/plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.js" type="text/javascript"></script>
    <script src="~/Areas/Admin/assets/global/plugins/jquery-ui/jquery-ui.min.js" type="text/javascript"></script>
    <script src="~/Areas/Admin/assets/global/plugins/bootstrap-summernote/summernote.min.js" type="text/javascript"></script>
}
@section ScriptPage
{
    <script src="~/Areas/Admin/assets/pages/scripts/components-editors.min.js" type="text/javascript"></script>
    <script src="~/Areas/Admin/assets/pages/scripts/components-bootstrap-switch.min.js" type="text/javascript"></script>
    <script src="~/Areas/Admin/assets/pages/scripts/components-bootstrap-tagsinput.min.js" type="text/javascript"></script>
    <script src="~/Areas/Admin/assets/pages/scripts/ui-modals.min.js" type="text/javascript"></script>
    <script>
        $('.selectpicker').selectpicker({
            style: 'form-control input-circle-right',
            //size: 6
        });

        function detectGallery(sender, e) {
            //debugger;
            var select = $('input[name="IsGallery"]').bootstrapSwitch('state');

            if (select == true) {
                $('#detailGallery').css('display', 'block');
            }
            else if (select == false) {
                $('#detailGallery').css('display', 'none');
            }
        }

    </script>

}
<div class="row">
    <div class="col-md-12">
        <div class="portlet light">

            <div class="portlet-title">
                <div class="caption font-red-sunglo">
                    <i class="icon-settings font-red-sunglo"></i>
                    <span class="caption-subject bold uppercase"> پست</span>
                </div>
            </div>

            <div class="portlet-body form">

                <form action="@Url.Action("Save", "Post")" method="post" class="" role="form">
                    @Html.AntiForgeryToken()
                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                    <div class="form-body">
                        <div class="row">
                            <div class="col-md-8">

                                <input type="hidden" name="ID" value="@Model.ID" />

                                <div class="form-group">
                                    <label class="control-label col-md-2">عنوان</label>
                                    <div class="col-md-10" style="margin-bottom: 10px;">
                                        <div class="input-group">
                                            <span class="input-group-addon input-circle-left">
                                                <i class="fa fa-bookmark-o"></i>
                                            </span>
                                            <input type="text" class="form-control input-circle-right" name="Title" placeholder="عنوان">
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="control-label col-md-2" for="ShortDescription">توضیحات کوتاه</label>
                                    <div class="col-md-10">
                                        <div class="summernoteEditor" name="ShortDescription" id="ShortDescription"> </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="LongDescription">توضیحات تکمیلی</label>
                                    <div class="col-md-10">
                                        <div class="summernoteEditor" name="LongDescription" id="LongDescription"> </div>
                                    </div>
                                </div>


                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label class="control-label col-md-4"> وضعیت پست</label>
                                            <div class="col-md-8">
                                                @if (Model.Actived == true)
                                                {
                                                    <input type="checkbox" class="make-switch" data-on-text="فعال" data-off-text="غیر فعال" name="Actived" data-on-color="success" data-off-color="danger" checked>
                                                }
                                                else
                                                {
                                                    <input type="checkbox" class="make-switch" data-on-text="فعال" data-off-text="غیر فعال" name="Actived" data-on-color="success" data-off-color="danger">
                                                }
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label class="control-label col-md-4"> وضعیت گالری</label>
                                            <div class="col-md-8">
                                                @if (Model.IsGallery == true)
                                                {
                                                    <input type="checkbox" class="make-switch" data-on-text="فعال" data-off-text="غیر فعال" name="IsGallery" data-on-color="success" data-off-color="danger" checked>
                                                }
                                                else
                                                {
                                                    <input type="checkbox" class="make-switch" data-on-text="فعال" data-off-text="غیر فعال" name="IsGallery" data-on-color="success" data-off-color="danger" onchange="detectGallery(this, event)">
                                                }
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                
                                <div class="form-group" id="detailGallery" style="display: none;">
                                    <label>انتصاب نقش</label>
                                    <div class="input-group">
                                        <span class="input-group-addon input-circle-left">
                                            <i class="fa fa-puzzle-piece"></i>
                                        </span>
                                        <select class="selectpicker form-control input-circle-right" name="PostGalleryID" data-live-search="true">
                                            <option value=""></option>
                                            @foreach (var gallery in Model.PostGalleries)
                                            {
                                                @if (gallery.ID == Model.PostGalleryID)
                                                 {
                                                     <option value="@gallery.ID" selected>@gallery.Name</option>
                                                 }
                                                 else
                                                 {
                                                     <option value="@gallery.ID">@gallery.Name</option>     
                                                 }
                                                
                                            }
                                        </select>
                                    </div>
                                </div>

                            </div>
                            <div class="col-md-4 border border-blue-hoki" style="padding: 10px">

                                <div class="form-group">
                                    <button type="submit" id="btn_submit" class="btn btn-circle btn-block green-jungle">
                                        <i class="fa fa-check"></i> ثبت
                                    </button>
                                </div>


                                <div class="form-group">
                                    <label class="control-label col-md-2">تگ ها</label>
                                    <div class="col-md-10">
                                        <input type="text" class="form-control input-large" value="@Model.SelectedTags" data-role="tagsinput">
                                    </div>
                                </div>


                                <div class="form-group">
                                    <label class="control-label col-md-3">دسته بندی</label>
                                    <div class="col-md-9">
                                        @BuildMenu(Model.Categories)

                                        @helper BuildMenu(IEnumerable<Category> data, long? parentId = null)
                                            {
                                                var items = data.Where(cat => cat.ParentId == parentId).OrderBy(cat => cat.Name);
                                                if (items.Any())
                                                {


                                                    foreach (var item in items)
                                                    {

                                                        //Model.CategoryId = item.Id;
                                                        if (item.ParentId != null)
                                                        {
                                                            <div class="checkbox" style="margin-left: 40px;">
                                                                <label for="CategoryId" style="margin-left: 30px;">
                                                                    @item.Name
                                                                </label>
                                                                @if (Model.CategoryID == item.ID)
                                                                {
                                                                    <input type="checkbox" id="CategoryId" name="CategoryId" value="@item.ID" checked>
                                                                }
                                                                else
                                                                {
                                                                    <input type="checkbox" id="CategoryId" name="CategoryId" value="@item.ID">
                                                                }
                                                            </div>
                                                        }
                                                        else
                                                        {
                                                            <div class="checkbox">
                                                                <label for="CategoryId" style="margin-left: 30px;">
                                                                    @item.Name
                                                                </label>
                                                                @if (Model.CategoryID == item.ID)
                                                                {
                                                                    <input type="checkbox" id="CategoryId" name="CategoryId" value="@item.ID" checked>
                                                                }
                                                                else
                                                                {
                                                                    <input type="checkbox" id="CategoryId" name="CategoryId" value="@item.ID">
                                                                }
                                                            </div>
                                                        }

                                                        @BuildMenu(data, item.ID)
                                                        ;
                                                    }
                                                }
                                }

                                    </div>
                                </div>

                                <br />
                                <br />
                                <div class="form-group">
                                    <label class="control-label col-md-4">تصویر اصلی </label>

                                    <div class="fileinput fileinput-new" data-provides="fileinput">
                                        <div class="fileinput-preview thumbnail" data-trigger="fileinput" style="width: 200px; height: 150px;">


                                        </div>
                                        <div>
                                            <span class="btn red btn-outline btn-file">
                                                <span class="fileinput-new"> انتخاب تصویر </span>
                                                <span class="fileinput-exists"> تغییر </span>
                                                <input type="file" name="image">
                                            </span>
                                            <a href="javascript:;" class="btn red fileinput-exists" data-dismiss="fileinput"> حذف </a>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>
                </form>


            </div>
        </div>

    </div>
</div>





